<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BytePlus CURL Parser</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #0a0a15 0%, #1a1a2e 50%, #16213e 100%);
      color: #00ff88;
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      padding: 30px;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    h1 {
      text-align: center;
      color: #fff;
      margin-bottom: 10px;
      font-size: 28px;
    }
    
    .subtitle {
      text-align: center;
      color: #888;
      margin-bottom: 30px;
      font-size: 14px;
    }
    
    .section {
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid #333;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      color: #888;
      font-size: 12px;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    textarea {
      width: 100%;
      background: #0a0a15;
      color: #00ff88;
      border: 2px solid #333;
      border-radius: 8px;
      padding: 15px;
      font-family: monospace;
      font-size: 12px;
      resize: vertical;
      transition: border-color 0.3s;
    }
    
    textarea:focus {
      outline: none;
      border-color: #00ff88;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.2);
    }
    
    textarea::placeholder {
      color: #444;
    }
    
    .btn-row {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    
    button {
      flex: 1;
      padding: 15px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
      transition: all 0.3s;
      font-family: inherit;
    }
    
    .btn-parse {
      background: linear-gradient(135deg, #00ff88, #00cc6a);
      color: #000;
    }
    
    .btn-parse:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(0, 255, 136, 0.4);
    }
    
    .btn-copy {
      background: linear-gradient(135deg, #0066ff, #0052cc);
      color: #fff;
    }
    
    .btn-copy:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(0, 102, 255, 0.4);
    }
    
    .btn-clear {
      background: #ff4444;
      color: #fff;
      flex: 0.3;
    }
    
    .output-section {
      border-color: #ffcc00;
    }
    
    .output-section label {
      color: #ffcc00;
    }
    
    .output-box {
      background: #0a0a15;
      border: 2px solid #ffcc00;
      border-radius: 8px;
      padding: 15px;
      color: #ffcc00;
      white-space: pre-wrap;
      word-break: break-all;
      font-size: 12px;
      min-height: 80px;
      max-height: 200px;
      overflow-y: auto;
    }
    
    .stats {
      display: flex;
      gap: 20px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    
    .stat-item {
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid #00ff88;
      border-radius: 8px;
      padding: 10px 15px;
      font-size: 12px;
    }
    
    .stat-item strong {
      color: #fff;
    }
    
    .instructions {
      background: rgba(0, 102, 255, 0.1);
      border: 1px solid #0066ff;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      font-size: 12px;
      color: #88aaff;
    }
    
    .instructions h3 {
      color: #0066ff;
      margin-bottom: 10px;
    }
    
    .instructions ol {
      margin-left: 20px;
    }
    
    .instructions li {
      margin-bottom: 5px;
    }
    
    .instructions code {
      background: #0a0a15;
      padding: 2px 6px;
      border-radius: 4px;
      color: #00ff88;
    }
    
    .error {
      background: rgba(255, 68, 68, 0.1);
      border: 1px solid #ff4444;
      color: #ff6666;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
      display: none;
    }
    
    .success {
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid #00ff88;
      color: #00ff88;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê BytePlus CURL Parser</h1>
    <p class="subtitle">Extract Cookie & X-CSRF-Token from cURL command</p>
    
    <div class="instructions">
      <h3>üìå Cara Pakai:</h3>
      <ol>
        <li>Buka <strong>Chrome DevTools</strong> (F12) ‚Üí Tab <strong>Network</strong></li>
        <li>Cari request <code>GetEnumConfiguration</code></li>
        <li>Klik kanan ‚Üí <strong>Copy</strong> ‚Üí <strong>Copy as cURL (cmd)</strong> atau <strong>Copy as cURL (bash)</strong></li>
        <li>Paste di bawah ‚Üí Klik <strong>üîç PARSE CURL</strong></li>
      </ol>
    </div>
    
    <div class="section">
      <label>üì• Paste CURL Command:</label>
      <textarea id="curl-input" rows="10" placeholder="Paste curl command here...

Contoh:
curl 'https://arkbff-ap-southeast1.console.byteplus.com/api/2024-10-01/GetEnumConfiguration?' \
  -H 'Accept: application/json' \
  -b 'cookie1=value1; cookie2=value2' \
  -H 'X-Csrf-Token: your-token-here'"></textarea>
      
      <div class="btn-row">
        <button class="btn-parse" id="btn-parse">üîç PARSE CURL</button>
        <button class="btn-clear" id="btn-clear">üóëÔ∏è CLEAR</button>
      </div>
      
      <div class="error" id="error-msg"></div>
      <div class="success" id="success-msg"></div>
    </div>
    
    <div class="section output-section">
      <label>üìã Output (Ready to Copy):</label>
      <div class="output-box" id="output">Waiting for input...</div>
      
      <div class="btn-row">
        <button class="btn-copy" id="btn-copy">üìã COPY OUTPUT</button>
      </div>
      
      <div class="stats" id="stats" style="display: none;">
        <div class="stat-item">üì¶ Cookie Length: <strong id="cookie-length">0</strong> chars</div>
        <div class="stat-item">üîë CSRF Token: <strong id="csrf-found">Not found</strong></div>
        <div class="stat-item">üç™ Cookie Count: <strong id="cookie-count">0</strong> items</div>
      </div>
    </div>
  </div>

  <script>
    // Fungsi untuk escape string JSON
    function escapeForJson(str) {
      if (!str) return '';
      return str
        .replace(/\\/g, '\\\\')
        .replace(/"/g, '\\"')
        .replace(/\n/g, '\\n')
        .replace(/\r/g, '\\r')
        .replace(/\t/g, '\\t');
    }

    // Fungsi untuk parse CURL command
    function parseCurl(curlCommand) {
      let cookie = '';
      let csrfToken = '';
      
      // Normalize curl command (remove line breaks dan escape characters)
      let normalized = curlCommand
        .replace(/\^\r?\n/g, ' ')      // Windows line continuation
        .replace(/\\\r?\n/g, ' ')      // Unix line continuation
        .replace(/\r?\n/g, ' ')        // Regular line breaks
        .replace(/\s+/g, ' ')          // Multiple spaces
        .trim();
      
      // Decode Windows CMD escape sequences
      normalized = normalized
        .replace(/\^"/g, '"')
        .replace(/\^\^/g, '^')
        .replace(/\^%\^/g, '%')
        .replace(/\^\$/g, '$')
        .replace(/\^{/g, '{')
        .replace(/\^}/g, '}')
        .replace(/\^\[/g, '[')
        .replace(/\^\]/g, ']')
        .replace(/\^\|/g, '|')
        .replace(/\^&/g, '&')
        .replace(/\^</g, '<')
        .replace(/\^>/g, '>');

      console.log('Normalized:', normalized);
      
      // Method 1: Extract cookie from -b flag
      const cookiePatterns = [
        /-b\s+['"](.*?)['"]/gi,                    // -b 'cookie' atau -b "cookie"
        /-b\s+\^['"](.*?)\^['"]/gi,                // -b ^'cookie^' (CMD escaped)
        /--cookie\s+['"](.*?)['"]/gi,              // --cookie 'value'
        /-b\s+([^\s]+?)(?:\s+-|$)/gi,              // -b cookie (tanpa quote)
      ];
      
      for (let pattern of cookiePatterns) {
        const matches = [...normalized.matchAll(pattern)];
        if (matches.length > 0) {
          cookie = matches[0][1];
          break;
        }
      }
      
      // Method 2: Extract from Cookie header
      if (!cookie) {
        const headerCookiePatterns = [
          /-H\s+['"]Cookie:\s*(.*?)['"]/gi,
          /-H\s+\^['"]Cookie:\s*(.*?)\^['"]/gi,
        ];
        
        for (let pattern of headerCookiePatterns) {
          const matches = [...normalized.matchAll(pattern)];
          if (matches.length > 0) {
            cookie = matches[0][1];
            break;
          }
        }
      }
      
      // Extract X-Csrf-Token
      const csrfPatterns = [
        /-H\s+['"]X-Csrf-Token:\s*(.*?)['"]/gi,
        /-H\s+\^['"]X-Csrf-Token:\s*(.*?)\^['"]/gi,
        /-H\s+['"x-csrf-token:\s*(.*?)['"]/gi,
      ];
      
      for (let pattern of csrfPatterns) {
        const matches = [...normalized.matchAll(pattern)];
        if (matches.length > 0) {
          csrfToken = matches[0][1].trim();
          break;
        }
      }
      
      // Clean up cookie value
      cookie = cookie
        .replace(/^\^/, '')
        .replace(/\^$/, '')
        .replace(/^['"]/, '')
        .replace(/['"]$/, '')
        .trim();
      
      return { cookie, csrfToken };
    }

    // Event Listeners
    document.getElementById('btn-parse').addEventListener('click', function() {
      const input = document.getElementById('curl-input').value;
      const output = document.getElementById('output');
      const errorMsg = document.getElementById('error-msg');
      const successMsg = document.getElementById('success-msg');
      const stats = document.getElementById('stats');
      
      errorMsg.style.display = 'none';
      successMsg.style.display = 'none';
      
      if (!input.trim()) {
        errorMsg.textContent = '‚ùå Please paste a curl command first!';
        errorMsg.style.display = 'block';
        return;
      }
      
      if (!input.toLowerCase().includes('curl')) {
        errorMsg.textContent = '‚ùå This doesn\'t look like a curl command!';
        errorMsg.style.display = 'block';
        return;
      }
      
      const result = parseCurl(input);
      
      if (!result.cookie && !result.csrfToken) {
        errorMsg.textContent = '‚ùå Could not find cookie or X-Csrf-Token in the curl command. Make sure you copied the full command.';
        errorMsg.style.display = 'block';
        return;
      }
      
      // Escape untuk JSON
      const escapedCookie = escapeForJson(result.cookie);
      const escapedCsrf = escapeForJson(result.csrfToken);
      
      // Format output
      const formattedOutput = `          "cookie": "${escapedCookie}",
          "csrf_token": "${escapedCsrf}"`;
      
      output.textContent = formattedOutput;
      
      // Update stats
      document.getElementById('cookie-length').textContent = result.cookie.length;
      document.getElementById('csrf-found').textContent = result.csrfToken ? '‚úì Found' : '‚úó Not found';
      document.getElementById('cookie-count').textContent = (result.cookie.match(/;/g) || []).length + 1;
      stats.style.display = 'flex';
      
      successMsg.textContent = '‚úÖ Successfully parsed! Click "COPY OUTPUT" to copy.';
      successMsg.style.display = 'block';
      
      this.textContent = '‚úÖ PARSED!';
      setTimeout(() => { this.textContent = 'üîç PARSE CURL'; }, 1500);
    });

    document.getElementById('btn-copy').addEventListener('click', function() {
      const output = document.getElementById('output').textContent;
      
      if (output === 'Waiting for input...' || output.includes('Error')) {
        this.textContent = '‚ùå No data!';
        setTimeout(() => { this.textContent = 'üìã COPY OUTPUT'; }, 1500);
        return;
      }
      
      navigator.clipboard.writeText(output).then(() => {
        this.textContent = '‚úÖ COPIED!';
        this.style.background = 'linear-gradient(135deg, #00cc6a, #009952)';
        setTimeout(() => {
          this.textContent = 'üìã COPY OUTPUT';
          this.style.background = 'linear-gradient(135deg, #0066ff, #0052cc)';
        }, 2000);
      });
    });

    document.getElementById('btn-clear').addEventListener('click', function() {
      document.getElementById('curl-input').value = '';
      document.getElementById('output').textContent = 'Waiting for input...';
      document.getElementById('stats').style.display = 'none';
      document.getElementById('error-msg').style.display = 'none';
      document.getElementById('success-msg').style.display = 'none';
    });
  </script>
</body>
</html>
